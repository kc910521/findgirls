/*eslint-env mocha*/
/*eslint-disable strict, no-console*/

var assert = require('assert');

describe('no active domain', function(){
  var nbs = require('../index'), wait = nbs.wait, resume = nbs.resume;

  beforeEach(function(){
    nbs.resetConfig();
  });
  
  it('shoud throw on an exit domain', function(done){
    if(process.domain) process.domain.exit();
    nbs.run(function(){
      process.domain.exit();
      assert.throws(function(){
        wait();
      });
      assert.throws(function(){
        resume();
      });
      done();
    }, done);
  });

  
});