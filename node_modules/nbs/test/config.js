/*eslint-env mocha*/
/*eslint-disable strict, no-console*/

var assert = require('assert');
var _ = require('underscore');

describe('config', function(){
  var nbs = require('../index');
  var defConf = _.extend({}, nbs.config());

  it('should use the conf error handler', function(done){
    nbs.config({onError: function(err){
      assert.equal(err.message, 'hello');
      done();
    }});
    nbs.run(function(){
      throw new Error('hello');
    });
  });
  
  it('should reset config', function(){
    assert(!_.isEqual(nbs.config(), defConf));
    assert(_.isEqual(nbs.resetConfig(), defConf));
  });

  it('should pass the invalid config', function(){
    assert(_.isEqual(nbs.config(1), defConf));
    assert(_.isEqual(nbs.config('111'), defConf));
    assert(_.isEqual(nbs.config({onError: 111, onSubError: 11}), defConf));
  });

  after(function(){
    nbs.resetConfig();
  });
});