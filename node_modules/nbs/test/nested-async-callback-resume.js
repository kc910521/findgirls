/*eslint-env mocha*/
/*eslint-disable strict, no-console*/

var assert = require('assert');

describe('nested async callback resume', function(){
  var nbs = require('../index'), wait = nbs.wait, resume = nbs.resume;

  beforeEach(function(){
    nbs.resetConfig();
  });
  
  it('should resume from multiple nested async callbacks', function(done){
    nbs.run(function(){
      setTimeout(function(){
        setTimeout(function(){
          resume(null, 1);
        }, 0);
      }, 0);
      var ret = wait();

      assert.equal(ret, 1);
      done();
    }, done);
  });

});